(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46c0fee6"],{"1ba8":function(t,e,n){"use strict";n("8c00")},"318a":function(t,e,n){t.exports=n.p+"img/logo.4653c8be.4653c8be.png"},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var a=n("1d80"),r=n("577e"),i=n("5899"),s="["+i+"]",c=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),o=function(t){return function(e){var n=r(a(e));return 1&t&&(n=n.replace(c,"")),2&t&&(n=n.replace(l,"")),n}};t.exports={start:o(1),end:o(2),trim:o(3)}},"5d99":function(t,e,n){},7409:function(t,e,n){},"7abe":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home-container"},[a("van-nav-bar",{staticClass:"app-nav-bar"},[a("template",{staticClass:"topbar-left",slot:"left"},[a("img",{staticClass:"logo",attrs:{alt:"logo",src:n("318a")}})]),a("template",{slot:"right"},[a("van-button",{staticClass:"search-btn",attrs:{block:"",icon:"search",round:"",size:"small",type:"info",to:"/search"}},[t._v("搜索 ")])],1)],2),a("van-tabs",{staticClass:"channel-tabs",model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[t._l(t.channels,(function(t){return a("van-tab",{key:t.id,staticClass:"channel-item",attrs:{title:t.name}},[a("article-list",{attrs:{channel:t}})],1)})),a("div",{staticClass:"placeholder",attrs:{slot:"nav-right"},slot:"nav-right"}),a("div",{staticClass:"wap-nav-wrap",attrs:{slot:"nav-right"},on:{click:function(e){t.isChannelEditShow=!0}},slot:"nav-right"},[a("van-icon",{attrs:{name:"wap-nav"}})],1)],2),a("van-popup",{staticClass:"channel-edit-popup",attrs:{"close-icon-position":"top-left",closeable:"","get-container":"body",position:"bottom",round:""},model:{value:t.isChannelEditShow,callback:function(e){t.isChannelEditShow=e},expression:"isChannelEditShow"}},[a("channel-edit",{attrs:{active:t.active,channels:t.channels},on:{close:function(e){t.isChannelEditShow=!1},"updata-active":function(e){t.active=e}}})],1)],1)},r=[],i=n("1da1"),s=n("5530"),c=(n("96cf"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"article-list",staticClass:"article-list"},[n("van-pull-refresh",{attrs:{"success-text":"刷新成功"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.articlesList,(function(t,e){return n("article-item",{key:e,attrs:{article:t,title:t.title}})})),1)],1)],1)}),l=[],o=n("2909"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{staticClass:"article-item",attrs:{to:{name:"article",params:{articleId:t.article.art_id}}}},[n("div",{staticClass:"title van-multi-ellipsis--l3",attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.article.title)+" ")]),n("div",{attrs:{slot:"label"},slot:"label"},[3===t.article.cover.type?n("div",{staticClass:"cover-wrap"},t._l(t.article.cover.images,(function(t,e){return n("van-image",{key:e,attrs:{width:"116",height:"73",fit:"cover",src:t}})})),1):t._e(),n("div",{staticClass:"label-wrap"},[n("span",[t._v(t._s(t.article.aut_name))]),n("span",[t._v(t._s(t.article.comm_count)+"评论")]),n("span",[t._v(t._s(t._f("dateTo")(t.article.pubdate)))])])]),1===t.article.cover.type?n("van-image",{staticClass:"right-cover",attrs:{fit:"cover",src:t.article.cover.images[0],referrerPolicy:"no-referrer"}}):t._e()],1)},d=[],h={name:"",components:{},props:{article:{type:Object,required:!0}},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},f=h,p=(n("cb3f"),n("2877")),v=Object(p["a"])(f,u,d,!1,null,"4ba3fd76",null),m=v.exports,b=n("2ef0"),g={name:"ArticleList",components:{ArticleItem:m},props:{channel:{type:Object,required:!0}},data:function(){return{articlesList:[],loading:!1,finished:!1,timestamp:null,refreshing:!1,scrollTop:0}},computed:{},watch:{},methods:{onLoad:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/app/v1_1/articles",{params:{channel_id:t.channel.id,timestamp:t.timestamp||Date.now(),with_top:1}});case 2:a=e.sent,r=a.data,i=r.data.results,(n=t.articlesList).push.apply(n,Object(o["a"])(i)),t.loading=!1,i.length?t.timestamp=r.data.pre_timestamp:t.finished=!0;case 8:case"end":return e.stop()}}),e)})))()},onRefresh:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/app/v1_1/articles",{params:{channel_id:t.channel.id,timestamp:Date.now(),with_top:1}});case 2:a=e.sent,r=a.data,i=r.data.results,(n=t.articlesList).unshift.apply(n,Object(o["a"])(i)),t.refreshing=!1,t.$toast({message:"更新了".concat(i.length,"条数据"),position:"top"});case 8:case"end":return e.stop()}}),e)})))()}},created:function(){this.onLoad()},mounted:function(){var t=this,e=this.$refs["article-list"];e.onscroll=Object(b["debounce"])((function(){t.scrollTop=e.scrollTop}),50)},activated:function(){this.$refs["article-list"].scrollTop=this.scrollTop},deactivated:function(){}},_=g,C=(n("e981"),Object(p["a"])(_,c,l,!1,null,"fe1a29d2",null)),w=C.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"channel-edit"},[n("van-cell",{attrs:{border:!1,center:""}},[n("template",{staticClass:"channel-title",slot:"title"},[t._v("我的频道")]),n("van-button",{staticClass:"edit-btn",attrs:{plain:"",round:"",size:"mini",type:"danger"},on:{click:function(e){t.isEdit=!t.isEdit}}},[t._v(" "+t._s(t.isEdit?"完成":"编辑")+" ")])],2),n("van-grid",{attrs:{gutter:10}},t._l(t.channels,(function(e,a){return n("van-grid-item",{key:e.id,staticClass:"grid-item",class:{active:t.active===a},attrs:{icon:t.isEdit&&0!==a?"close":"",text:e.name},on:{click:function(n){return t.onUserChannelClick(e,a)}}})})),1),n("van-cell",{attrs:{border:!1,center:""}},[n("template",{slot:"title"},[t._v("频道推荐")])],2),n("van-grid",{attrs:{gutter:10}},t._l(t.recommendChannel,(function(e){return n("van-grid-item",{key:e.id,staticClass:"grid-item",attrs:{text:e.name},on:{click:function(n){return t.onAdd(e)}}})})),1)],1)},k=[],E=(n("a9e3"),n("4de4"),n("7db0"),n("a434"),n("2f62")),O=n("5d2d"),y={name:"ChannelEdit",components:{},props:{channels:{required:!0,type:Array},active:{required:!0,type:Number}},data:function(){return{allChannelsList:[],isEdit:!1}},computed:Object(s["a"])(Object(s["a"])({},Object(E["b"])(["user"])),{},{recommendChannel:function(){var t=this;return this.allChannelsList.filter((function(e){return!t.channels.find((function(t){return t.id===e.id}))}))}}),watch:{},methods:{getAllChannelsList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/app/v1_0/channels");case 2:n=e.sent,a=n.data,t.allChannelsList=a.data.channels;case 5:case"end":return e.stop()}}),e)})))()},onAdd:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.channels.push(t),!e.user){n.next=6;break}return n.next=4,e.$axios.patch("/app/v1_0/user/channels",{channels:[{id:t.id,seq:e.channels.length}]});case 4:n.next=7;break;case 6:Object(O["c"])("user-channel",e.channels);case 7:case"end":return n.stop()}}),n)})))()},onUserChannelClick:function(t,e){this.isEdit&&0!==e?this.deleteChannel(t,e):this.switcheChanel(e)},deleteChannel:function(t,e){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e<=n.active&&n.$emit("updata-active",n.active-1),n.channels.splice(e,1),!n.user){a.next=7;break}return a.next=5,n.$axios.delete("/app/v1_0/user/channels/".concat(t.id));case 5:a.next=8;break;case 7:Object(O["c"])("user-channel",n.channels);case 8:case"end":return a.stop()}}),a)})))()},switcheChanel:function(t){this.$emit("updata-active",t),this.$emit("close")}},created:function(){this.getAllChannelsList()},mounted:function(){}},j=y,A=(n("e504"),Object(p["a"])(j,x,k,!1,null,"ec1d49ac",null)),I=A.exports,N={name:"Home",components:{ArticleList:w,ChannelEdit:I},props:{},data:function(){return{active:0,channels:[],isChannelEditShow:!1}},computed:Object(s["a"])({},Object(E["b"])(["user"])),watch:{},methods:{getChannelsList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[],!t.user){e.next=9;break}return e.next=4,t.$axios.get("/app/v1_0/user/channels");case 4:a=e.sent,r=a.data,n=r.data.channels,e.next=19;break;case 9:if(i=Object(O["a"])("user-channel"),!i){e.next=14;break}n=i,e.next=19;break;case 14:return e.next=16,t.$axios.get("/app/v1_0/user/channels");case 16:s=e.sent,c=s.data,n=c.data.channels;case 19:t.channels=n;case 20:case"end":return e.stop()}}),e)})))()}},created:function(){this.getChannelsList()},mounted:function(){}},L=N,R=(n("1ba8"),Object(p["a"])(L,a,r,!1,null,"c349ebce",null));e["default"]=R.exports},"7db0":function(t,e,n){"use strict";var a=n("23e7"),r=n("b727").find,i=n("44d2"),s="find",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),a({target:"Array",proto:!0,forced:c},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(s)},"8c00":function(t,e,n){},a9e3:function(t,e,n){"use strict";var a=n("83ab"),r=n("da84"),i=n("94ca"),s=n("6eeb"),c=n("5135"),l=n("c6b6"),o=n("7156"),u=n("d9b5"),d=n("c04e"),h=n("d039"),f=n("7c73"),p=n("241c").f,v=n("06cf").f,m=n("9bf2").f,b=n("58a8").trim,g="Number",_=r[g],C=_.prototype,w=l(f(C))==g,x=function(t){if(u(t))throw TypeError("Cannot convert a Symbol value to a number");var e,n,a,r,i,s,c,l,o=d(t,"number");if("string"==typeof o&&o.length>2)if(o=b(o),e=o.charCodeAt(0),43===e||45===e){if(n=o.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(o.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+o}for(i=o.slice(2),s=i.length,c=0;c<s;c++)if(l=i.charCodeAt(c),l<48||l>r)return NaN;return parseInt(i,a)}return+o};if(i(g,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var k,E=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof E&&(w?h((function(){C.valueOf.call(n)})):l(n)!=g)?o(new _(x(e)),n,E):x(e)},O=a?p(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),y=0;O.length>y;y++)c(_,k=O[y])&&!c(E,k)&&m(E,k,v(_,k));E.prototype=C,C.constructor=E,s(r,g,E)}},cb3f:function(t,e,n){"use strict";n("7409")},d67e:function(t,e,n){},e504:function(t,e,n){"use strict";n("5d99")},e981:function(t,e,n){"use strict";n("d67e")}}]);
//# sourceMappingURL=chunk-46c0fee6.7b3c820f.js.map