(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00524f39"],{"230c":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"artive-container"},[n("van-nav-bar",{staticClass:"app-nav-bar",attrs:{"left-arrow":"",title:"文章详情"},on:{"click-left":function(e){return t.$router.back()}}}),n("div",{staticClass:"article-wrap"},[n("h3",{staticClass:"title"},[t._v(t._s(t.article.title))]),n("van-cell",{attrs:{center:"",size:"user-info"}},[n("van-image",{staticClass:"avatar",attrs:{slot:"icon",src:t.article.aut_photo,fit:"cover",round:""},slot:"icon"}),n("div",{staticClass:"name",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.article.aut_name))]),n("div",{staticClass:"pubdate",attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t._f("dateTo")(t.article.pubdate))+" ")]),n("van-button",{staticClass:"follow-btn",attrs:{icon:t.article.is_followed?"":"plus",loading:t.isFollowLoading,type:t.article.is_followed?"default":"info",round:"",size:"small"},on:{click:t.focusOn}},[t._v(" "+t._s(t.article.is_followed?"已关注":"关注")+" ")])],1),n("div",{ref:"article-conertent",staticClass:"markdown-body",domProps:{innerHTML:t._s(t.article.content)}}),n("div",{staticClass:"article-end"},[t._v("正文结束")]),n("comment-list",{attrs:{source:t.articleId,list:t.commentList},on:{"reply-click":t.onReplyClick,"updata-total-count":function(e){t.totalCount=e}}})],1),n("van-cell",{staticClass:"bottom-bar",attrs:{center:""}},[n("van-button",{attrs:{slot:"title",hairline:"",plain:"",round:"",size:"small"},on:{click:function(e){t.commentShow=!0}},slot:"title"},[t._v(" 写评论 ")]),n("div",{staticClass:"bottom-bar-icon"},[n("van-icon",{attrs:{badge:t.totalCount,name:"comment-o"}}),n("van-icon",{attrs:{color:t.article.is_collected?"#3296FA":"",name:t.article.is_collected?"star":"star-o"},on:{click:t.collect}}),n("van-icon",{attrs:{color:1===t.article.attitude?"#d71345":"",name:1===t.article.attitude?"like":"like-o"},on:{click:t.like}}),n("van-icon",{attrs:{name:"share-o"}})],1)],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.commentShow,callback:function(e){t.commentShow=e},expression:"commentShow"}},[n("write-comments",{attrs:{target:t.articleId},on:{"post-success":t.onPostSuccess}})],1),t.isReplyShow?n("van-popup",{style:{height:"80%"},attrs:{position:"bottom"},model:{value:t.isReplyShow,callback:function(e){t.isReplyShow=e},expression:"isReplyShow"}},[n("comment-reply",{attrs:{articleId:t.articleId,comment:t.comment},on:{close:function(e){t.isReplyShow=!1}}})],1):t._e()],1)},a=[],r=n("1da1"),i=n("5530"),s=(n("96cf"),n("a9e3"),n("4160"),n("159b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-list"},[n("van-cell",{attrs:{title:"全部评论"}}),n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,o){return n("comment-item",{key:o,attrs:{item:e},on:{"reply-click":function(e){return t.$emit("reply-click",e)}}})})),1)],1)}),c=[],l=n("2909"),u=(n("d3b7"),n("25f0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-item"},[n("van-cell",{staticClass:"user-info",attrs:{center:""}},[n("van-image",{staticClass:"avatar",attrs:{slot:"icon",src:t.item.aut_photo,fit:"cover",round:""},slot:"icon"}),n("div",{attrs:{slot:"title"},slot:"title"},[n("div",{staticClass:"title-warp"},[n("div",{staticClass:"name"},[t._v(t._s(t.item.aut_name))]),n("div",{staticClass:"like-warp"},[n("van-icon",{class:{liked:t.item.is_liking},attrs:{name:t.item.is_liking?"good-job":"good-job-o"},on:{click:t.onCommentLike}}),n("span",[t._v(t._s(t.item.like_count))])],1)]),n("div",{staticClass:"content"},[t._v(" "+t._s(t.item.content)+" ")]),n("div",{staticClass:"time-reply"},[n("span",{staticClass:"pubdate",attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t._f("datetime")(t.item.pubdate))+" ")]),n("van-button",{staticClass:"reply-btn",attrs:{round:"",size:"mini"},on:{click:function(e){return t.$emit("reply-click",t.item)}}},[t._v(" "+t._s(t.item.reply_count)+"回复 ")])],1)])],1)],1)}),m=[],p={name:"CommentItem",components:{},props:{item:{required:!0,type:Object}},data:function(){return{}},computed:{},watch:{},methods:{onCommentLike:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.$store.state.user){e.next=5;break}if(t.item.is_liking)try{t.$axios({method:"delete",url:"/app/v1_0/comment/likings/".concat(t.item.com_id.toString())}),t.item.like_count--,t.$toast.success({message:"取消成功"})}catch(n){console.log(n),t.$toast({message:"未知错误",position:"top"})}else try{t.$axios({method:"POST",url:"/app/v1_0/comment/likings",data:{target:t.item.com_id.toString()}}),t.item.like_count++,t.$toast.success({message:"点赞成功"})}catch(n){console.log(n),t.$toast({message:"未知错误",position:"top"})}t.item.is_liking=!t.item.is_liking,e.next=8;break;case 5:return t.$toast({message:"未登录",position:"top"}),e.next=8,t.$router.push("/login");case 8:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){}},d=p,f=(n("d289"),n("2877")),v=Object(f["a"])(d,u,m,!1,null,"33a8f2c2",null),h=v.exports,b={name:"CommentList",components:{CommentItem:h},props:{source:{type:[Object,Number,String],required:!0},list:{type:Array,default:function(){return[]}},type:{type:String,default:"a"}},data:function(){return{loading:!1,finished:!1,offset:null,limit:10}},computed:{},watch:{},methods:{onLoad:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o,a,r,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/app/v1_0/comments",{params:{type:t.type,source:t.source.toString(),offset:t.offset,limit:t.limit}});case 2:o=e.sent,a=o.data,r=a.data,i=r.results,s=r.total_count,(n=t.list).push.apply(n,Object(l["a"])(i)),t.loading=!1,t.$emit("updata-total-count",s),i.length?t.offset=a.data.last_id:t.finished=!0;case 9:case"end":return e.stop()}}),e)})))()}},created:function(){this.onLoad()},mounted:function(){}},g=b,_=Object(f["a"])(g,s,c,!1,null,"4c3057d1",null),w=_.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"write-comments"},[n("van-field",{staticClass:"post-inp",attrs:{border:!1,autosize:"",maxlength:"30",placeholder:"优质评论将会被优先展示","show-word-limit":"",type:"textarea"},model:{value:t.content,callback:function(e){t.content="string"===typeof e?e.trim():e},expression:"content"}}),n("van-button",{staticClass:"post-btn",attrs:{disabled:!this.content,round:"",size:"small"},on:{click:t.postComment}},[t._v(" 发布 ")])],1)},k=[],x={name:"WriteComments",components:{},props:{target:[Number,String,Object],articleId:{type:[Number,String,Object],default:null}},data:function(){return{content:""}},computed:{},watch:{},methods:{postComment:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$toast.loading({message:"发布中...",forbidClick:!0,duration:0}),e.next=3,t.$axios({method:"POST",url:"/app/v1_0/comments",data:{target:t.target.toString(),content:t.content,art_id:null===t.articleId?null:t.articleId.toString()}});case 3:n=e.sent,o=n.data,t.$emit("post-success",o.data.new_obj),t.$toast.success("发布成功！"),t.content="";case 8:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){}},C=x,$=(n("3984"),Object(f["a"])(C,y,k,!1,null,"6229e2ff",null)),S=$.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-reply"},[n("van-nav-bar",{attrs:{title:t.comment.reply_count+"条回复"}},[n("van-icon",{attrs:{slot:"left",name:"cross"},on:{click:function(e){return t.$emit("close")}},slot:"left"})],1),n("comment-item",{attrs:{item:t.comment}}),n("comment-list",{attrs:{source:t.comment.com_id,type:"c",list:t.commentList}}),n("van-cell",{staticClass:"bottom-bar",attrs:{center:""}},[n("van-button",{attrs:{slot:"title",hairline:"",plain:"",round:"",size:"small"},on:{click:function(e){t.isPostShow=!0}},slot:"title"},[t._v(" 写评论 ")])],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.isPostShow,callback:function(e){t.isPostShow=e},expression:"isPostShow"}},[n("write-comments",{attrs:{target:t.comment.com_id,articleId:t.articleId},on:{"post-success":t.onPostSuccess}})],1)],1)},A=[],O={name:"CommentReply",components:{commentItem:h,commentList:w,writeComments:S},props:{comment:{type:Object,required:!0},articleId:{type:[Number,String,Object],required:!0}},data:function(){return{isPostShow:!1,commentList:[]}},computed:{},watch:{},methods:{onPostSuccess:function(t){this.commentList.unshift(t),this.comment.reply_count++,this.isPostShow=!1}},created:function(){},mounted:function(){}},R=O,j=(n("981d"),Object(f["a"])(R,I,A,!1,null,"7080ab13",null)),E=j.exports,N=(n("945f"),n("28a2")),L=n("2f62"),P={name:"Article",components:{CommentList:w,WriteComments:S,CommentReply:E},data:function(){return{article:{},isFollowLoading:!1,commentShow:!1,commentList:[],totalCount:0,isReplyShow:!1,comment:{}}},props:{articleId:{type:[String,Number,Object],required:!0}},computed:Object(i["a"])({},Object(L["b"])(["user"])),watch:{},methods:{onReplyClick:function(t){this.isReplyShow=!0,this.comment=t},getArticle:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/app/v1_0/articles/".concat(t.articleId));case 2:n=e.sent,o=n.data,t.article=o.data,t.$nextTick((function(){t.handlingPreviewImage()}));case 6:case"end":return e.stop()}}),e)})))()},handlingPreviewImage:function(){var t=this.$refs["article-conertent"],e=t.querySelectorAll("img"),n=[];e.forEach((function(t,e){n.push(t.src),t.onclick=function(){Object(N["a"])({images:n,startPosition:e})}}))},focusOn:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isFollowLoading=!0,t.user){e.next=7;break}return t.$toast.fail("未登录，正在为您跳转登录界面"),e.next=5,t.$router.push("/login");case 5:e.next=32;break;case 7:if(t.article.is_followed){e.next=20;break}return e.prev=8,e.next=11,t.$axios({method:"post",url:"/app/v1_0/user/followings",data:{target:t.article.aut_id}});case 11:t.$toast.success("关注成功"),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](8),console.log(e.t0),t.$toast.fail("未知错误，别点了");case 18:e.next=30;break;case 20:return e.prev=20,e.next=23,t.$axios({method:"DELETE",url:"/app/v1_0/user/followings/".concat(t.article.aut_id)});case 23:t.$toast.success("取消关注成功"),e.next=30;break;case 26:e.prev=26,e.t1=e["catch"](20),console.log(e.t1),t.$toast.fail("未知错误，别点了");case 30:t.article.is_followed=!t.article.is_followed,t.isFollowLoading=!1;case 32:case"end":return e.stop()}}),e,null,[[8,14],[20,26]])})))()},collect:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.user){e.next=28;break}if(t.article.is_collected){e.next=15;break}return e.prev=2,e.next=5,t.$axios({method:"post",url:"/app/v1_0/article/collections",data:{target:t.articleId}});case 5:t.article.is_collected=!0,t.$toast({message:"收藏成功",position:"top"}),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0),t.$toast({message:"未知错误",position:"top"});case 13:e.next=26;break;case 15:return e.prev=15,e.next=18,t.$axios({method:"delete",url:"/app/v1_0/article/collections/".concat(t.articleId)});case 18:t.article.is_collected=!1,t.$toast({message:"取消收藏成功",position:"top"}),e.next=26;break;case 22:e.prev=22,e.t1=e["catch"](15),console.log(e.t1),t.$toast({message:"未知错误",position:"top"});case 26:e.next=31;break;case 28:return t.$toast({message:"未登录",position:"top"}),e.next=31,t.$router.push("/login");case 31:case"end":return e.stop()}}),e,null,[[2,9],[15,22]])})))()},like:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.user){e.next=29;break}if(1===t.article.attitude){e.next=15;break}return t.article.attitude=1,e.prev=3,e.next=6,t.$axios({method:"post",url:"/app/v1_0/article/likings",data:{target:t.articleId}});case 6:t.$toast({message:"点赞成功",position:"top"}),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](3),console.log(e.t0),t.$toast({message:"未知错误",position:"top"});case 13:e.next=27;break;case 15:if(1!==t.article.attitude){e.next=27;break}return t.article.attitude=-1,e.prev=17,e.next=20,t.$axios({method:"delete",url:"/app/v1_0/article/likings/".concat(t.articleId)});case 20:t.$toast({message:"取消点赞成功",position:"top"}),e.next=27;break;case 23:e.prev=23,e.t1=e["catch"](17),console.log(e.t1),t.$toast({message:"未知错误",position:"top"});case 27:e.next=32;break;case 29:return t.$toast({message:"未登录",position:"top"}),e.next=32,t.$router.push("/login");case 32:case"end":return e.stop()}}),e,null,[[3,9],[17,23]])})))()},onPostSuccess:function(t){this.commentList.unshift(t),this.totalCount++,this.commentShow=!1}},created:function(){this.getArticle()}},T=P,F=(n("62b9"),Object(f["a"])(T,o,a,!1,null,"0a41f68a",null));e["default"]=F.exports},"25f0":function(t,e,n){"use strict";var o=n("6eeb"),a=n("825a"),r=n("577e"),i=n("d039"),s=n("ad6d"),c="toString",l=RegExp.prototype,u=l[c],m=i((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),p=u.name!=c;(m||p)&&o(RegExp.prototype,c,(function(){var t=a(this),e=r(t.source),n=t.flags,o=r(void 0===n&&t instanceof RegExp&&!("flags"in l)?s.call(t):n);return"/"+e+"/"+o}),{unsafe:!0})},"273e":function(t,e,n){},2909:function(t,e,n){"use strict";function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function a(t){if(Array.isArray(t))return o(t)}n.d(e,"a",(function(){return c}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}n("fb6a");function i(t,e){if(t){if("string"===typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return a(t)||r(t)||i(t)||s()}},3984:function(t,e,n){"use strict";n("3c15")},"3c15":function(t,e,n){},"4df4":function(t,e,n){"use strict";var o=n("0366"),a=n("7b0b"),r=n("9bdd"),i=n("e95a"),s=n("50c4"),c=n("8418"),l=n("35a1");t.exports=function(t){var e,n,u,m,p,d,f=a(t),v="function"==typeof this?this:Array,h=arguments.length,b=h>1?arguments[1]:void 0,g=void 0!==b,_=l(f),w=0;if(g&&(b=o(b,h>2?arguments[2]:void 0,2)),void 0==_||v==Array&&i(_))for(e=s(f.length),n=new v(e);e>w;w++)d=g?b(f[w],w):f[w],c(n,w,d);else for(m=_.call(f),p=m.next,n=new v;!(u=p.call(m)).done;w++)d=g?r(m,b,[u.value,w],!0):u.value,c(n,w,d);return n.length=w,n}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var o=n("1d80"),a=n("577e"),r=n("5899"),i="["+r+"]",s=RegExp("^"+i+i+"*"),c=RegExp(i+i+"*$"),l=function(t){return function(e){var n=a(o(e));return 1&t&&(n=n.replace(s,"")),2&t&&(n=n.replace(c,"")),n}};t.exports={start:l(1),end:l(2),trim:l(3)}},"62b9":function(t,e,n){"use strict";n("db96")},7156:function(t,e,n){var o=n("861d"),a=n("d2bb");t.exports=function(t,e,n){var r,i;return a&&"function"==typeof(r=e.constructor)&&r!==n&&o(i=r.prototype)&&i!==n.prototype&&a(t,i),t}},"945f":function(t,e,n){},"981d":function(t,e,n){"use strict";n("273e")},"9bdd":function(t,e,n){var o=n("825a"),a=n("2a62");t.exports=function(t,e,n,r){try{return r?e(o(n)[0],n[1]):e(n)}catch(i){throw a(t),i}}},a630:function(t,e,n){var o=n("23e7"),a=n("4df4"),r=n("1c7e"),i=!r((function(t){Array.from(t)}));o({target:"Array",stat:!0,forced:i},{from:a})},a9e3:function(t,e,n){"use strict";var o=n("83ab"),a=n("da84"),r=n("94ca"),i=n("6eeb"),s=n("5135"),c=n("c6b6"),l=n("7156"),u=n("d9b5"),m=n("c04e"),p=n("d039"),d=n("7c73"),f=n("241c").f,v=n("06cf").f,h=n("9bf2").f,b=n("58a8").trim,g="Number",_=a[g],w=_.prototype,y=c(d(w))==g,k=function(t){if(u(t))throw TypeError("Cannot convert a Symbol value to a number");var e,n,o,a,r,i,s,c,l=m(t,"number");if("string"==typeof l&&l.length>2)if(l=b(l),e=l.charCodeAt(0),43===e||45===e){if(n=l.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:o=2,a=49;break;case 79:case 111:o=8,a=55;break;default:return+l}for(r=l.slice(2),i=r.length,s=0;s<i;s++)if(c=r.charCodeAt(s),c<48||c>a)return NaN;return parseInt(r,o)}return+l};if(r(g,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var x,C=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof C&&(y?p((function(){w.valueOf.call(n)})):c(n)!=g)?l(new _(k(e)),n,C):k(e)},$=o?f(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),S=0;$.length>S;S++)s(_,x=$[S])&&!s(C,x)&&h(C,x,v(_,x));C.prototype=w,w.constructor=C,i(a,g,C)}},d289:function(t,e,n){"use strict";n("f4ff")},db96:function(t,e,n){},f4ff:function(t,e,n){},fb6a:function(t,e,n){"use strict";var o=n("23e7"),a=n("861d"),r=n("e8b5"),i=n("23cb"),s=n("50c4"),c=n("fc6a"),l=n("8418"),u=n("b622"),m=n("1dde"),p=m("slice"),d=u("species"),f=[].slice,v=Math.max;o({target:"Array",proto:!0,forced:!p},{slice:function(t,e){var n,o,u,m=c(this),p=s(m.length),h=i(t,p),b=i(void 0===e?p:e,p);if(r(m)&&(n=m.constructor,"function"!=typeof n||n!==Array&&!r(n.prototype)?a(n)&&(n=n[d],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return f.call(m,h,b);for(o=new(void 0===n?Array:n)(v(b-h,0)),u=0;h<b;h++,u++)h in m&&l(o,u,m[h]);return o.length=u,o}})}}]);
//# sourceMappingURL=chunk-00524f39.74eae3ac.js.map