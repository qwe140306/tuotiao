(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e8f8ab6"],{"111b":function(e,t,n){},"9ed6":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-container"},[n("van-nav-bar",{staticClass:"app-nav-bar",attrs:{"left-arrow":"",title:"登录/注册"},on:{"click-left":function(t){return e.$router.back()}}}),n("van-form",{ref:"loginForm",attrs:{"show-error":!1,"show-error-message":!1,"validate-first":""},on:{failed:e.onFailed,submit:e.onLogin}},[n("van-field",{attrs:{rules:e.formRules.mobile,"icon-prefix":"iconfont icon","left-icon":"shouji",name:"mobile",placeholder:"请输入手机号码"},model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}}),n("van-field",{attrs:{rules:e.formRules.code,clearable:"","icon-prefix":"iconfont icon","left-icon":"yanzhengma",placeholder:"请输入验证码"},scopedSlots:e._u([{key:"button",fn:function(){return[e.isCountDownsh?n("van-count-down",{attrs:{time:6e4,format:"ss s"},on:{finish:function(t){e.isCountDownsh=!1}}}):n("van-button",{staticClass:"send-btn",attrs:{block:"",round:"",size:"mini",loading:e.isSendSmsLoading},on:{click:function(t){return t.preventDefault(),e.onSendSms.apply(null,arguments)}}},[e._v("获取验证码 ")])]},proxy:!0}]),model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}}),n("div",{staticClass:"login-btn-wrap"},[n("van-button",{staticClass:"login-btn",attrs:{block:"",type:"info"}},[e._v("登录")])],1)],1)],1)},s=[],a=n("1da1"),r=(n("96cf"),n("ac1f"),n("5319"),n("bc3a")),i=n.n(r),c={name:"Login",components:{},props:{},data:function(){return{user:{mobile:"13911111111",code:"246810"},formRules:{mobile:[{required:!0,message:"请输入手机号"},{pattern:/^1[3|56789]\d{9}$/,message:"手机号格式错误"}],code:[{required:!0,message:"请输入验证码"},{pattern:/^\d{6}$/,message:"验证码格式错误"}]},isCountDownsh:!1,isSendSmsLoading:!1}},computed:{},watch:{},methods:{onLogin:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$toast.loading({message:"登陆中",forbidClick:!0,duration:0}),t.prev=1,t.next=4,i.a.post("/app/v1_0/authorizations",e.user);case 4:n=t.sent,o=n.data,console.log(o),e.$toast.success("登录成功"),e.$store.commit("setUser",o.data),e.$store.commit("removeCachePages","Layout"),e.$router.replace(e.$route.query.redirect||"/"),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](1),console.log(t.t0),e.$toast.fail("登录失败,请稍后重试");case 17:case"end":return t.stop()}}),t,null,[[1,13]])})))()},onFailed:function(e){e.errors[0]&&this.$toast({message:e.errors[0].message,position:"top"})},onSendSms:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isSendSmsLoading=!0,t.prev=1,t.next=4,e.$refs.loginForm.validate("mobile");case 4:return e.isCountDownsh=!0,t.next=7,e.$axios.get("/app/v1_0/sms/codes/".concat(e.user.mobile));case 7:t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),n=t.t0&&t.t0.response&&429===t.t0.response.status?"验证码发送频繁，请稍后重试！":"mobile"===t.t0.name?t.t0.message:"发送失败，请稍后重试！",e.$toast({message:n,position:"top"});case 13:e.isSendSmsLoading=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()}},created:function(){},mounted:function(){}},u=c,l=(n("a7ae"),n("2877")),m=Object(l["a"])(u,o,s,!1,null,"55e0a848",null);t["default"]=m.exports},a7ae:function(e,t,n){"use strict";n("111b")}}]);
//# sourceMappingURL=chunk-1e8f8ab6.846b59da.js.map